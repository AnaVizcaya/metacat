
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Command Line Interface &#8212; MetaCat  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MetaCat Web API" href="webapi.html" />
    <link rel="prev" title="MetaCat Concepts" href="concepts.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="webapi.html" title="MetaCat Web API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="concepts.html" title="MetaCat Concepts"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MetaCat  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Command Line Interface</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="command-line-interface">
<h1>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this heading">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>You will need Python 3.7 or newer.</p>
<p>Preferred way to install the client is using pip:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ pip install metacat --user
$ pip3 install metacat --user
</pre></div>
</div>
</div></blockquote>
<p>Alternatively, it can be installed from github:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/ivmfnal/metacat.git
$ <span class="nb">cd</span> metacat
$ python setup.py install --user
</pre></div>
</div>
</div></blockquote>
<p>Make sure ~/.local/bin is in your PATH:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/.local/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
</div></blockquote>
<p>If you use your own Python installation, e.g. Anaconda or Miniconda, then you can do this instead:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ python setup.py install
</pre></div>
</div>
</div></blockquote>
<p>It is also possible to install MetaCat client from a tarball from <a class="reference external" href="https://cdcvs.fnal.gov/redmine/projects/metacat/files">https://cdcvs.fnal.gov/redmine/projects/metacat/files</a></p>
</div>
<div class="section" id="general-cli-command-syntax">
<h2>General CLI command syntax<a class="headerlink" href="#general-cli-command-syntax" title="Permalink to this heading">¶</a></h2>
<p>General command looks like this:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat <span class="o">[</span>-s &lt;server URL&gt;<span class="o">]</span> <span class="o">[</span>-a &lt;auth server URL&gt;<span class="o">]</span> &lt;command&gt; <span class="o">[</span><span class="nb">command</span> options<span class="o">]</span> <span class="o">[</span>arguments ...<span class="o">]</span>
</pre></div>
</div>
</div></blockquote>
<p>-a is used to specify the URL for the authenticartion server. It is used only for authentication commands.
-s option specified the server URL. Alternativey, you can define the METACAT_AUTH_SERVER_URL and METACAT_SERVER_URL environment variables:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">METACAT_SERVER_URL</span><span class="o">=</span><span class="s2">&quot;http://server:port/path&quot;</span>
$ <span class="nb">export</span> <span class="nv">METACAT_AUTH_SERVER_URL</span><span class="o">=</span><span class="s2">&quot;http://auth_server:port/auth_path&quot;</span>
$ metacat &lt;<span class="nb">command</span> group&gt; &lt;command&gt; <span class="o">[</span><span class="nb">command</span> options<span class="o">]</span> <span class="o">[</span>arguments ...<span class="o">]</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="versions">
<h2>Versions<a class="headerlink" href="#versions" title="Permalink to this heading">¶</a></h2>
<p>To quickly check the connectivity to the MetaCat server and see what software versions are used on the server
and the client sides, use the <code class="docutils literal notranslate"><span class="pre">version</span></code> command:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat version
MetaCat Server URL:         https://metacat.fnal.gov:9443/dune_meta_demo/app
Authentication server URL:  https://metacat.fnal.gov:8143/auth/dune
Server version:             <span class="m">3</span>.9.1
Client version:             <span class="m">3</span>.9.1
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="user-authentication">
<h2>User Authentication<a class="headerlink" href="#user-authentication" title="Permalink to this heading">¶</a></h2>
<p>Main purpose of MetaCat authentication commands is to obtain an authentication token and store it in
the MetaCat <em>token library</em> located at ~/.metacat_tokens. The library may contain multiple
tokens, one per MetaCat server instance the user communicates with. The instances are identified
by their URL.</p>
<p>To obtain a new token, use <code class="docutils literal notranslate"><span class="pre">metacat</span> <span class="pre">auth</span> <span class="pre">login</span></code> command. Currently, 2 authentication mechanisms
are implemented: password and X.509 certificates. LDAP or MetacCat server “local” password can be used with the
password autentication. X.509 method supports both X.509 certificates and proxies.</p>
<p>Token obtained using CLI <code class="docutils literal notranslate"><span class="pre">metacat</span> <span class="pre">auth</span> <span class="pre">login</span></code> command can be further used by both CLI and API until it expires.</p>
<p>To obtain a new token using password authentication, use the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat auth login &lt;username&gt;
</pre></div>
</div>
<p>To use X.805 authentication</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat auth login -m x509 -c &lt;cert file&gt; -k &lt;key file&gt; &lt;username&gt;
$ metacat auth login -m x509 -c &lt;proxy file&gt; &lt;username&gt;
</pre></div>
</div>
<p>Environment variables X509_USER_CERT, X509_USER_KEY and X509_USER_PROXY can be used instead of -c and -k options:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">X509_USER_PROXY</span><span class="o">=</span>~/user_proxy
$ metacat auth login -m x509 &lt;username&gt;
</pre></div>
</div>
<p>Before X.509 method is enabled for the user, the user needs to contact the MetaCat amdinistrator to enter their
subject DN into MetaCat user database. In order to obtain the DN of the user certificate, use <code class="docutils literal notranslate"><span class="pre">metacat</span> <span class="pre">auth</span> <span class="pre">mydn</span></code> command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat auth mydn -c my_cert.pem -k my_key.pem
<span class="nv">CN</span><span class="o">=</span>UID:jjohnson,CN<span class="o">=</span>John Johnson,OU<span class="o">=</span>People,O<span class="o">=</span>Fermi National Accelerator Laboratory,C<span class="o">=</span>US,DC<span class="o">=</span>cilogon,DC<span class="o">=</span>org
</pre></div>
</div>
<p>If you want to use your X.509 proxy, then you need to send the issuer DN instead of the subject DN to the administrator. Use <code class="docutils literal notranslate"><span class="pre">-i</span></code>
option with <code class="docutils literal notranslate"><span class="pre">mydn</span></code> command to get the issuer DN:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat auth mydn -c my_proxy -i
<span class="nv">CN</span><span class="o">=</span>UID:jjohnson,CN<span class="o">=</span>John Johnson,OU<span class="o">=</span>People,O<span class="o">=</span>Fermi National Accelerator Laboratory,C<span class="o">=</span>US,DC<span class="o">=</span>cilogon,DC<span class="o">=</span>org
</pre></div>
</div>
<p>List available tokens</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat auth list
</pre></div>
</div>
<p>Export token to a file or to stdout</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat auth token <span class="o">[</span>-o &lt;token file&gt;<span class="o">]</span>
</pre></div>
</div>
<p>On successful authentication, the following command will show your username and the token expiration:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat auth whoami <span class="o">[</span>-t &lt;token file&gt;<span class="o">]</span>
User:    jdoe
Expires: Fri Jul <span class="m">20</span> <span class="m">12</span>:35:10 <span class="m">2022</span>
</pre></div>
</div>
</div>
<div class="section" id="namespaces">
<h2>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat namespace create my_namespace
$ metacat namespace create -o owner_role my_namespace
$ metacat namespace list <span class="s2">&quot;protodune*&quot;</span>
$ metacat namespace show protodune-sp
</pre></div>
</div>
</div>
<div class="section" id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this heading">¶</a></h2>
<p>To create dataset in a namespace or to modify the dataset content or metadata, the user must be an owner of the dataset’s namespace,
either directly or through a role.</p>
<div class="section" id="creating-a-dataset">
<h3>Creating a dataset<a class="headerlink" href="#creating-a-dataset" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset create <span class="o">[</span>&lt;options&gt;<span class="o">]</span> &lt;namespace&gt;:&lt;name&gt; <span class="o">[</span>&lt;description&gt;<span class="o">]</span>
        -M<span class="p">|</span>--monotonic
        -F<span class="p">|</span>--frozen
        -m<span class="p">|</span>--metadata <span class="s1">&#39;&lt;JSON expression&gt;&#39;</span>
        -m<span class="p">|</span>--metadata @&lt;JSON file&gt;
</pre></div>
</div>
<p>A multi-word description does not have to be put in quotes. E.g., the following two commands are equivalent:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset create scope:name Carefully selected files
$ metacat dataset create scope:name <span class="s2">&quot;Carefully selected files&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="listing-existing-datasets">
<h3>Listing existing datasets<a class="headerlink" href="#listing-existing-datasets" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset list <span class="o">[</span>&lt;options&gt;<span class="o">]</span> <span class="o">[[</span>&lt;namespace pattern&gt;:<span class="o">]</span>&lt;name pattern&gt;<span class="o">]</span>
        -l<span class="p">|</span>--long           - detailed output
        -c<span class="p">|</span>--file-counts    - include file counts <span class="k">if</span> detailed output
</pre></div>
</div>
<p>Namespace and name patterns are UNIX ls style patterns (recognizing <a href="#id1"><span class="problematic" id="id2">*</span></a>?[]). Examples:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset list <span class="s1">&#39;production:*.[0-3].dat&#39;</span>
$ metacat dataset list *:A*
</pre></div>
</div>
<p>When using -l option, user can also use -c to request dataset file counts. In this case, it may take additional time to calculate the file counts for large datasets.</p>
</div>
<div class="section" id="updating-a-dataset-metadata-and-flags">
<h3>Updating a dataset metadata and flags<a class="headerlink" href="#updating-a-dataset-metadata-and-flags" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset update &lt;options&gt; &lt;namespace&gt;:&lt;name&gt; <span class="o">[</span>&lt;description&gt;<span class="o">]</span>
        -M<span class="p">|</span>--monotonic <span class="o">(</span>yes<span class="p">|</span>no<span class="o">)</span> - set/reset monotonic flag
        -F<span class="p">|</span>--frozen <span class="o">(</span>yes<span class="p">|</span>no<span class="o">)</span>    - set/reset monotonic flag
        -r<span class="p">|</span>--replace            - replace metadata, otherwise update
        -m<span class="p">|</span>--metadata @&lt;JSON file with metadata&gt;
        -m<span class="p">|</span>--metadata <span class="s1">&#39;&lt;JSON expression&gt;&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="listing-files-in-the-dataset">
<h3>Listing files in the dataset<a class="headerlink" href="#listing-files-in-the-dataset" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset files <span class="o">[</span>&lt;options&gt;<span class="o">]</span> &lt;dataset namespace&gt;:&lt;dataset name&gt;
        -m<span class="p">|</span>--with-metadata      - include file metadata
        -j                      - as JSON
</pre></div>
</div>
</div>
<div class="section" id="adding-removing-subsets-to-from-a-dataset">
<h3>Adding/removing subsets to/from a dataset<a class="headerlink" href="#adding-removing-subsets-to-from-a-dataset" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat dataset add &lt;parent dataset namespace&gt;:&lt;parent name&gt; &lt;child dataset namespace&gt;:&lt;child name&gt; <span class="o">[</span>&lt;child dataset namespace&gt;:&lt;child name&gt; ...<span class="o">]</span>
$ metacat dataset remove &lt;parent namespace&gt;:&lt;parent name&gt; &lt;child namespace&gt;:&lt;child name&gt;
</pre></div>
</div>
<p>When adding a dataset to another dataset, MetaCat checks whether the operation will create a circle in the ancestor/descendent relationship and refuses
to do so.</p>
</div>
</div>
<div class="section" id="declaring-new-files">
<h2>Declaring new Files<a class="headerlink" href="#declaring-new-files" title="Permalink to this heading">¶</a></h2>
<p>Create JSON file with metadata:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;namespace&quot;</span><span class="p">:</span><span class="s2">&quot;namespace&quot;</span><span class="p">,</span>    <span class="c1"># optional - use -N to specify default</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>              <span class="c1"># optional</span>
        <span class="s2">&quot;auto_name&quot;</span><span class="p">:</span><span class="n">pattern</span><span class="p">,</span>        <span class="c1"># optional</span>
        <span class="s2">&quot;fid&quot;</span><span class="p">:</span><span class="s2">&quot;...&quot;</span><span class="p">,</span>                <span class="c1"># optional - if missing, new will be generated. If specified, must be unique</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">},</span>        <span class="c1"># optional</span>
        <span class="s2">&quot;parents&quot;</span><span class="p">:</span>  <span class="p">[</span> <span class="s2">&quot;fid1&quot;</span><span class="p">,</span> <span class="s2">&quot;fid2&quot;</span><span class="p">,</span> <span class="o">...</span> <span class="p">]</span>     <span class="c1"># optional, must be file ids</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span>   <span class="mi">1234</span>              <span class="c1"># required - size of the file in bytes</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>You can get a sample of the JSON file:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat file <span class="nb">declare</span> --sample
</pre></div>
</div>
<p>Declare files:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">declare</span> <span class="o">[</span>-N<span class="p">|</span>--namespace &lt;default namespace&gt;<span class="o">]</span> -j<span class="p">|</span>--json &lt;json file&gt; <span class="o">[</span>&lt;dataset namespace&gt;:<span class="o">]</span>&lt;dataset&gt;
</pre></div>
</div>
<p>When declaring multiple files, the command accepts JSON file path. The JSON file provides information about the files being declared. The JSON structure in the file
must be a list of dictionaries, one dictionary per file to be declared. Each dictionary has the following items:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">fid</span></code><span class="classifier">optional</span></dt><dd><p>File ID for the new file. Must be unique for the MetaCat instance.
If unspecified, MetaCat will assign the hexadecimal representation of a random UUID (32 hex digits) as the file ID.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">namespace</span></code><span class="classifier">optional</span></dt><dd><p>Namespace for the file. If unspecified, the default namespace specified with <code class="docutils literal notranslate"><span class="pre">-N</span></code> will be used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="classifier">optional</span></dt><dd><p>File name. The file name must be unique within the namespace. If unspecified, the name will be auto-generated or the file ID will be used as the name.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">auto_name</span></code><span class="classifier">optional</span></dt><dd><p>Pattern to be used to generate new file name. The pattern is may include constant parts and parts to be replaced by the MetaCat in
the following order:</p>
<ul class="simple">
<li><p>$clock3   - lower 3 digits of UNIX timestamp in milliseconds as integer (milliseconds portion of the timestamp)</p></li>
<li><p>$clock6   - lower 6 digits of UNIX timestamp in milliseconds as integer</p></li>
<li><p>$clock    - entire UNIX UNIX timestamp in milliseconds as integer</p></li>
<li><p>$uuid8    - 8 hex digits of a random UUID</p></li>
<li><p>$uuid16   - 16 hex digits of a random UUID</p></li>
<li><p>$uuid     - 32 hex digits of a random UUID</p></li>
<li><p>$fid      - file ID</p></li>
</ul>
<p>For example, the pattern <code class="docutils literal notranslate"><span class="pre">file_$uuid8_$clock6.dat</span></code> may generate file name <code class="docutils literal notranslate"><span class="pre">file_13d79a37_601828.dat</span></code>.</p>
<p>If neither <code class="docutils literal notranslate"><span class="pre">name</span></code> nor <code class="docutils literal notranslate"><span class="pre">auto_name</span></code> are provided, then <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">ID</span></code> will be used as the file name.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size</span></code><span class="classifier">required</span></dt><dd><p>File size in bytes</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">metadata</span></code><span class="classifier">optional</span></dt><dd><p>File metadata as dictionary</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">parents</span></code><span class="classifier">optional</span></dt><dd><p>List of parent files IDs</p>
</dd>
</dl>
<p>When declaring a file or multiple files, they must be added to a dataset.</p>
</div>
<div class="section" id="adding-files-to-dataset">
<h2>Adding files to dataset<a class="headerlink" href="#adding-files-to-dataset" title="Permalink to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat add -n &lt;namespace&gt;:&lt;name&gt;<span class="o">[</span>,...<span class="o">]</span> &lt;dataset namespace&gt;:&lt;dataset name&gt;
metacat add -n @&lt;file with names&gt; &lt;dataset namespace&gt;:&lt;dataset name&gt;
metacat add -n - &lt;dataset namespace&gt;:&lt;dataset name&gt;             <span class="c1"># read file namesspace:name&#39;s from stdin</span>

metacat add -i &lt;file id&gt;<span class="o">[</span>,...<span class="o">]</span> &lt;dataset namespace&gt;:&lt;dataset name&gt;
metacat add -i @&lt;file with ids&gt; &lt;dataset namespace&gt;:&lt;dataset name&gt;
metacat add -i - &lt;dataset namespace&gt;:&lt;dataset name&gt;             <span class="c1"># read file ids from stdin</span>

metacat add -j &lt;JSON file&gt; &lt;dataset namespace&gt;:&lt;dataset name&gt;
</pre></div>
</div>
<p>JSON file structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;namespace:name&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;fid&quot;</span><span class="p">:</span><span class="s2">&quot;...&quot;</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Get a sample of the JSON file:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat file add --sample
</pre></div>
</div>
<p><strong>Example:</strong> add files from dataset A but not in dataset B to dataset C:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ metacat query -i -N <span class="nb">test</span> <span class="s2">&quot;files from A - files from B&quot;</span> &gt; file_ids.txt
$ metacat file add -i @file_ids.txt test:C
</pre></div>
</div>
</div>
<div class="section" id="file-metadata">
<h2>File Metadata<a class="headerlink" href="#file-metadata" title="Permalink to this heading">¶</a></h2>
<div class="section" id="updating">
<h3>Updating<a class="headerlink" href="#updating" title="Permalink to this heading">¶</a></h3>
<p>Create JSON file with metadata values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">3.14</span><span class="p">,</span>
    <span class="s2">&quot;run_type&quot;</span><span class="p">:</span> <span class="s2">&quot;calibration&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Update metadata:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat update -n &lt;namespace&gt;:&lt;name&gt;<span class="o">[</span>,...<span class="o">]</span> @metadata.json
metacat update -n @&lt;file with names&gt; @metadata.json
metacat update -n - @metadata.json             <span class="c1"># read file namesspace:name&#39;s from stdin</span>

metacat update -i &lt;file id&gt;<span class="o">[</span>,...<span class="o">]</span> @metadata.json
metacat update -i @&lt;file with ids&gt; @metadata.json
metacat update -i - @metadata.json             <span class="c1"># read file ids from stdin</span>

or you can put new metadata inline:

metacat update -n &lt;namespace&gt;:&lt;name&gt;<span class="o">[</span>,...<span class="o">]</span> <span class="s1">&#39;{&quot;x&quot;: 3.14, &quot;run_type&quot;: &quot;calibration&quot;}&#39;</span>
...
</pre></div>
</div>
</div>
<div class="section" id="retrieving">
<h3>Retrieving<a class="headerlink" href="#retrieving" title="Permalink to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat file show &lt;namespace&gt;:&lt;name&gt;            <span class="c1"># - by namespace/name</span>
metacat file show -i &lt;fid&gt;                      <span class="c1"># - by file id</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="query">
<h2>Query<a class="headerlink" href="#query" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="mql.html"><span class="doc">MQL - Metadata Query Language</span></a></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>metacat query &lt;options&gt; <span class="s2">&quot;&lt;MQL query&gt;&quot;</span>
metacat query &lt;options&gt; -f &lt;MQL query file&gt;

Options:
    -j<span class="p">|</span>--json                           - print raw JSON output
    -p<span class="p">|</span>--pretty                         - pretty-print metadata
    -l<span class="p">|</span>--line                           - print all metadata on single line <span class="o">(</span>good <span class="k">for</span> grepping, ignored with -j and -p<span class="o">)</span>
    -i<span class="p">|</span>--ids                            - print file ids instead of names
    -s<span class="p">|</span>--summary                        - print only summary information
    -m<span class="p">|</span>--metadata<span class="o">=[</span>&lt;field&gt;,...<span class="o">]</span>         - print metadata fields
                                          overrides --summary
    -m<span class="p">|</span>--metadata<span class="o">=</span>all                   - print all metadata fields
                                          overrides --summary
    -P<span class="p">|</span>--with-provenance                - include provenance information
    -N<span class="p">|</span>--namespace<span class="o">=</span>&lt;default namespace&gt;  - default namespace <span class="k">for</span> the query
    -S<span class="p">|</span>--save-as<span class="o">=</span>&lt;namespace&gt;:&lt;name&gt;     - save files as a new datset
    -A<span class="p">|</span>--add-to<span class="o">=</span>&lt;namespace&gt;:&lt;name&gt;      - add files to an existing dataset
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Command Line Interface</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#general-cli-command-syntax">General CLI command syntax</a></li>
<li><a class="reference internal" href="#versions">Versions</a></li>
<li><a class="reference internal" href="#user-authentication">User Authentication</a></li>
<li><a class="reference internal" href="#namespaces">Namespaces</a></li>
<li><a class="reference internal" href="#datasets">Datasets</a><ul>
<li><a class="reference internal" href="#creating-a-dataset">Creating a dataset</a></li>
<li><a class="reference internal" href="#listing-existing-datasets">Listing existing datasets</a></li>
<li><a class="reference internal" href="#updating-a-dataset-metadata-and-flags">Updating a dataset metadata and flags</a></li>
<li><a class="reference internal" href="#listing-files-in-the-dataset">Listing files in the dataset</a></li>
<li><a class="reference internal" href="#adding-removing-subsets-to-from-a-dataset">Adding/removing subsets to/from a dataset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#declaring-new-files">Declaring new Files</a></li>
<li><a class="reference internal" href="#adding-files-to-dataset">Adding files to dataset</a></li>
<li><a class="reference internal" href="#file-metadata">File Metadata</a><ul>
<li><a class="reference internal" href="#updating">Updating</a></li>
<li><a class="reference internal" href="#retrieving">Retrieving</a></li>
</ul>
</li>
<li><a class="reference internal" href="#query">Query</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="concepts.html"
                          title="previous chapter">MetaCat Concepts</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="webapi.html"
                          title="next chapter">MetaCat Web API</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ui.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="webapi.html" title="MetaCat Web API"
             >next</a> |</li>
        <li class="right" >
          <a href="concepts.html" title="MetaCat Concepts"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MetaCat  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Command Line Interface</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Igor Mandrichenko.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>